{{ define "cssInclude"}}
<style>
table,td,th {
	border:1px solid black;
	border-collapse:collapse;
	padding:2px 10px;
}

th {
	background-color:lightgrey;
}
</style>
{{ end }}

{{ define "jsInclude"}}
{{ end }}

{{ define "content" }}
<h1>Holdings</h1>
<div id="table"/>

<script type="text/javascript">
	var holdingdata = [{"name": "abc", "price": "124."}];
	//var myList = [{"name" : "abc", "age" : 50},
	//			  {"age" : "25", "hobby" : "swimming"},
	//			  {"name" : "xyz", "hobby" : "programming"}];

	// Builds the HTML Table out of myList.
	function buildHtmlTable(selector) {
		var columns = addAllColumnHeaders(selector);

		for (var i = 0 ; i < holdingdata.length ; i++) {
			var row$ = $('<tr/>');
			for (var colIndex = 0 ; colIndex < columns.length ; colIndex++) {
				var cellValue = holdingdata[i][columns[colIndex]];

				if (cellValue == null) { cellValue = ""; }

				row$.append($('<td/>').html(cellValue));
			}
			$(selector).append(row$);
		}
	}

	// Adds a header row to the table and returns the set of columns.
	// Need to do union of keys from all records as some records may not contain
	// all records
	function addAllColumnHeaders(selector)
	{
		var columnSet = [];
		var headerTr$ = $('<tr/>');

		for (var i = 0 ; i < data.length ; i++) {
			var rowHash = data[i];
			for (var key in rowHash) {
				if ($.inArray(key, columnSet) == -1){
					columnSet.push(key);
					headerTr$.append($('<th/>').html(key));
				}
			}
		}
		$(selector).append(headerTr$);

		return columnSet;
	}

	$.getJSON('/holding/get', function(data) {
		console.log(data)
		holdingdata = data;
		buildHtmlTable('#table')
	});
	

</script>

{{ end }}
